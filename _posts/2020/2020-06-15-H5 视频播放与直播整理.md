---
layout: post
title: H5 视频播放与直播整理
categories: Js HTML
---

## Video 视频播放

HTML5支持video和audio之前， 网页播放流媒体文件， 都是通过其它方法， 例如 activeX 插件 或者 flash
支持后，页面可以在web服务器上放置视频文件， 浏览器根据支持的视频格式请求相应的视频文件

### 标签规范
video 标签 ：[https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/video](https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/video)   
HTMLMediaElement ：[https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLMediaElement](https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLMediaElement)   

### 常用 option
* src 视频地址
* poster 视频封面，没有播放时显示的图片
* preload 预加载
* autoplay 自动播放
* loop 循环播放
* controls 浏览器自带的控制条
* muted 静音播放

### 常用 属性 (HTMLMediaElement)
* buffered 返回哪部分已被下载，会返回一个 TimeRanges 对象，(只读)
* currentTime 当前播放时间，(只读)
* duration 视频总长，(只读)
* paused 是否处于暂停状态，(只读)
* playbackRate 播放速度
* volume 音量

### 常用 方法  (HTMLMediaElement)
* pause() 暂停播放。
* play() 开始播放。

### 常用 事件 (HTMLMediaElement)
* canplay 有足够的可用数据可以播放媒体时触发
* pause	当播放状态更改为暂停时发送
* play 当播放状态更改为播放时发送
* ratechange 播放速度变化时触发
* timeupdate 当前播放事件变化时触发
* volumechange 音量大小变化时触发

### Tips
#### 1. autoplay 属性限制
autoplay 属性在多种浏览器上有阻止策略，需要用户手动调整浏览器播放策略才能够实现自动播放。

解决办法：将视频设置为静音播放，并给予用户提示，参考刷新 bilibili 直播页面后的交互。


#### 2. 视频下载原理

一个非常大的视频，video 标签是如何实现快速开始播放的？又是如何实现播放进度控制的？

#### 3. 自定义进度条时遇到的死循环问题

#### 4. 进度条预览、外部预览功能实现

#### 5. “高能进度条”实现

#### 6. “弹幕功能”实现

#### 7. “防档弹幕”实现
